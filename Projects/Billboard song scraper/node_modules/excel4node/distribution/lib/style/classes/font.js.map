{"version":3,"sources":["../../../../source/lib/style/classes/font.js"],"names":["xmlbuilder","require","types","Font","opts","color","excelColor","getColor","name","scheme","size","family","fontFamily","validate","vertAlign","charset","condense","extend","bold","italics","outline","shadow","strike","underline","obj","fontXML","fEle","ele","att","undefined","toLowerCase","module","exports"],"mappings":"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","file":"font.js","sourcesContent":["const xmlbuilder = require('xmlbuilder');\nconst types = require('../../types/index.js');\n\nclass Font {\n    /**\n     * @class Font\n     * @desc Instance of Font with properties\n     * @param {Object} opts Options for Font\n     * @param {String} opts.color HEX color of font\n     * @param {String} opts.name Name of Font. i.e. Calibri\n     * @param {String} opts.scheme Font Scheme. defaults to major\n     * @param {Number} opts.size Pt size of Font\n     * @param {String} opts.family Font Family. defaults to roman\n     * @param {String} opts.vertAlign Specifies font as subscript or superscript\n     * @param {Number} opts.charset Character set of font as defined in ยง18.4.1 charset (Character Set) or standard\n     * @param {Boolean} opts.condense Macintosh compatibility settings to squeeze text together when rendering\n     * @param {Boolean} opts.extend Stretches out the text when rendering\n     * @param {Boolean} opts.bold States whether font should be bold\n     * @param {Boolean} opts.italics States whether font should be in italics\n     * @param {Boolean} opts.outline States whether font should be outlined\n     * @param {Boolean} opts.shadow States whether font should have a shadow\n     * @param {Boolean} opts.strike States whether font should have a strikethrough\n     * @param {Boolean} opts.underline States whether font should be underlined\n     * @retuns {Font}\n     */\n    constructor(opts) {\n        opts = opts ? opts : {};\n\n        typeof opts.color === 'string' ? this.color = types.excelColor.getColor(opts.color) : null;\n        typeof opts.name === 'string' ? this.name = opts.name : null;\n        typeof opts.scheme === 'string' ? this.scheme = opts.scheme : null;\n        typeof opts.size === 'number' ? this.size = opts.size : null;\n        typeof opts.family === 'string' && types.fontFamily.validate(opts.family) === true ? this.family = opts.family : null;\n\n        typeof opts.vertAlign === 'string' ? this.vertAlign = opts.vertAlign : null;\n        typeof opts.charset === 'number' ? this.charset = opts.charset : null;\n\n        typeof opts.condense === 'boolean' ? this.condense = opts.condense : null;\n        typeof opts.extend === 'boolean' ? this.extend = opts.extend : null;\n        typeof opts.bold === 'boolean' ? this.bold = opts.bold : null;\n        typeof opts.italics === 'boolean' ? this.italics = opts.italics : null;\n        typeof opts.outline === 'boolean' ? this.outline = opts.outline : null;\n        typeof opts.shadow === 'boolean' ? this.shadow = opts.shadow : null;\n        typeof opts.strike === 'boolean' ? this.strike = opts.strike : null;\n        typeof opts.underline === 'boolean' ? this.underline = opts.underline : null;\n    }\n\n    /** \n     * @func Font.toObject\n     * @desc Converts the Font instance to a javascript object\n     * @returns {Object}\n     */\n    toObject() {\n        let obj = {};\n\n        typeof this.charset === 'number' ? obj.charset = this.charset : null;\n        typeof this.color === 'string' ? obj.color = this.color : null;\n        typeof this.family === 'string' ? obj.family = this.family : null;\n        typeof this.name === 'string' ? obj.name = this.name : null;\n        typeof this.scheme === 'string' ? obj.scheme = this.scheme : null;\n        typeof this.size === 'number' ? obj.size = this.size : null;\n        typeof this.vertAlign === 'string' ? obj.vertAlign = this.vertAlign : null;\n\n        typeof this.condense === 'boolean' ? obj.condense = this.condense : null;\n        typeof this.extend === 'boolean' ? obj.extend = this.extend : null;\n        typeof this.bold === 'boolean' ? obj.bold = this.bold : null;\n        typeof this.italics === 'boolean' ? obj.italics = this.italics : null;\n        typeof this.outline === 'boolean' ? obj.outline = this.outline : null;\n        typeof this.shadow === 'boolean' ? obj.shadow = this.shadow : null;\n        typeof this.strike === 'boolean' ? obj.strike = this.strike : null;\n        typeof this.underline === 'boolean' ? obj.underline = this.underline : null;\n\n        return obj;\n    }\n\n    /**\n     * @alias Font.addToXMLele\n     * @desc When generating Workbook output, attaches style to the styles xml file\n     * @func Font.addToXMLele\n     * @param {xmlbuilder.Element} ele Element object of the xmlbuilder module\n     */\n    addToXMLele(fontXML) {\n        let fEle = fontXML.ele('font');\n\n        // Place styling elements first to avoid validation errors with .NET validator\n        this.condense === true ? fEle.ele('condense') : null;\n        this.extend === true ? fEle.ele('extend') : null;\n        this.bold === true ? fEle.ele('b') : null;\n        this.italics === true ? fEle.ele('i') : null;\n        this.outline === true ? fEle.ele('outline') : null;\n        this.shadow === true ? fEle.ele('shadow') : null;\n        this.strike === true ? fEle.ele('strike') : null;\n        this.underline === true ? fEle.ele('u') : null;\n        this.vertAlign === true ? fEle.ele('vertAlign') : null;\n\n        fEle.ele('sz').att('val', this.size !== undefined ? this.size : 12);\n        fEle.ele('color').att('rgb', this.color !== undefined ? this.color : 'FF000000');\n        fEle.ele('name').att('val', this.name !== undefined ? this.name : 'Calibri');\n        if (this.family !== undefined) {\n            fEle.ele('family').att('val', types.fontFamily[this.family.toLowerCase()]);\n        }\n        if (this.scheme !== undefined) {\n            fEle.ele('scheme').att('val', this.scheme);\n        }\n\n\n        return true;\n    }\n\n\n}\n\nmodule.exports = Font;"]}